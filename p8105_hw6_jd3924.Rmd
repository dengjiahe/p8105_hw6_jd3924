---
title: "p8105_hw6_jd3924"
author: "Jiahe Deng"
date: "2022-12-01"
output: github_document
---

```{r}
library(tidyverse)
library(dplyr)
library(readr)
library(mgcv)
library(modelr)
```

```{r}
homicides_data = 
  read_csv("homicide-data.csv") %>%
  mutate(
    city_state = str_c(city,state, sep = ","),
    victim_age = as.numeric(victim_age),
    resolved = ifelse(disposition %in% c("Closed without arrest","Open/No arrest"), "unsolved","solved")) %>%
  filter(victim_race %in% c("White", "Black"),
         city_state != "Tulsa,AL")

homicides_data
```
```{r}
baltimore_df = 
  homicides_data %>%
  filter(city_state == "Baltimore,MD")
baltimore_df
```
```{r}
fit_logistic = 
  baltimore_df %>% 
  mutate(resolved = as.factor(resolved)) %>%
  glm(resolved ~ victim_age + victim_race + victim_sex, data = ., family = binomial())

fit_logistic %>% 
  broom::tidy() %>% 
  mutate(OR = exp(estimate),
         lower = exp(estimate - 1.96 * std.error),
         upper = exp(estimate + 1.96 * std.error)) %>%
  knitr::kable(digits = 3)

